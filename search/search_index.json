{"config":{"lang":["pt"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Home","text":""},{"location":"#descricao","title":"Descri\u00e7\u00e3o","text":"<p>O Excel Structure Validator \u00e9 um projeto Python destinado a validar a estrutura de arquivos Excel. Ele compara arquivos Excel recebidos com um modelo pr\u00e9-definido para assegurar que os dados cumpram com os padr\u00f5es estabelecidos. </p>"},{"location":"#fluxo","title":"Fluxo","text":"<pre><code>flowchart LR \n    A[Folder: Input]--&gt;|Compara Schema| B(Folder: Modelo)\n    B --&gt; C{Validator}\n    C --&gt;|Arquivo correto| D[Folder: Output Correto] \n    C --&gt;|Log com detalhes| D[Folder: Output Correto] \n    C --&gt;|Arquivo incorreto| E[Folder: Output Incorreto]\n    C --&gt;|Log com detalhes| E[Folder: Output Incorreto] </code></pre>"},{"location":"#aplicacao","title":"Aplica\u00e7\u00e3o","text":"<p>O projeto \u00e9 ideal para cen\u00e1rios onde a qualidade e a consist\u00eancia dos dados s\u00e3o cr\u00edticas para an\u00e1lises subsequentes, como importa\u00e7\u00f5es para o Power BI, an\u00e1lises de dados, entre outros.</p> <p>Antes de iniciar avalie os arquivos em excel dentro da pasta data/input e data/modelo para entender o comportamento do projeto. Para facilitar, criei arquivos simples com 4 at\u00e9 6 colunas e poucas linhas, por\u00e9m o conceito se aplica a qualquer modelo e/ou quantidade de colunas/linhas.</p>"},{"location":"#antes-de-rodar-o-script","title":"Antes de rodar o script","text":""},{"location":"#depois-de-rodar-o-script-e-com-o-resultado-da-auditoria","title":"Depois de rodar o script e com o resultado da auditoria","text":""},{"location":"#validacoes","title":"Valida\u00e7\u00f5es","text":"<p>S\u00e3o 6 valida\u00e7\u00f5es que o nosso projeto est\u00e1 configurado</p> <p>Verifica se as colunas do modelo est\u00e3o na mesma ordem em rela\u00e7\u00e3o ao arquivo recebido.</p> Source code in <code>app/validacoes/colunas_estao_presentes_na_mesma_ordem.py</code> <pre><code>def validar_se_todas_as_colunas_estao_presentes_na_mesma_ordem(\n    excel_modelo: DataFrame, arquivo: DataFrame\n) -&gt; Tuple[bool, str]:\n\"\"\"\n    Verifica se as colunas do modelo est\u00e3o na mesma ordem em rela\u00e7\u00e3o ao arquivo recebido.\n    \"\"\"\n    if excel_modelo.columns.equals(arquivo.columns):\n        return True, 'As colunas est\u00e3o na mesma ordem.'\n    else:\n        return False, 'As colunas n\u00e3o est\u00e3o na mesma ordem.'\n</code></pre> <p>Verifica se todas as colunas do modelo est\u00e3o presentes no arquivo recebido.</p> Source code in <code>app/validacoes/colunas_estao_presentes.py</code> <pre><code>def validar_se_todas_as_colunas_estao_presentes(\n    excel_modelo: DataFrame, arquivo: DataFrame\n) -&gt; Tuple[bool, str]:\n\"\"\"\n    Verifica se todas as colunas do modelo est\u00e3o presentes no arquivo recebido.\n    \"\"\"\n    if set(excel_modelo.columns) == set(arquivo.columns):\n        return True, 'Todas as colunas est\u00e3o presentes.'\n    else:\n        return False, 'Algumas colunas n\u00e3o est\u00e3o presentes.'\n</code></pre> <p>Verifica se o arquivo recebido tem colunas a mais em rela\u00e7\u00e3o ao modelo.</p> Source code in <code>app/validacoes/existem_colunas_a_mais.py</code> <pre><code>def validar_se_existem_colunas_a_mais(\n    excel_modelo: DataFrame, arquivo: DataFrame\n) -&gt; Tuple[bool, str]:\n\"\"\"\n    Verifica se o arquivo recebido tem colunas a mais em rela\u00e7\u00e3o ao modelo.\n    \"\"\"\n    colunas_a_mais = set(arquivo.columns) - set(excel_modelo.columns)\n    return len(colunas_a_mais) == 0, list(colunas_a_mais)\n</code></pre> <p>Verifica se o arquivo recebido tem colunas a menos em rela\u00e7\u00e3o ao modelo.</p> Source code in <code>app/validacoes/existem_colunas_a_menos.py</code> <pre><code>def validar_se_existem_colunas_a_menos(\n    excel_modelo: DataFrame, arquivo: DataFrame\n) -&gt; Tuple[bool, str]:\n\"\"\"\n    Verifica se o arquivo recebido tem colunas a menos em rela\u00e7\u00e3o ao modelo.\n    \"\"\"\n    colunas_a_mais = set(excel_modelo.columns) - set(arquivo.columns)\n    return len(colunas_a_mais) == 0, list(colunas_a_mais)\n</code></pre> <p>Verifica se o arquivo recebido tem o mesmo n\u00famero de linhas em rela\u00e7\u00e3o ao modelo.</p> Source code in <code>app/validacoes/quantidade_de_linhas.py</code> <pre><code>def validar_quantidade_de_linhas(\n    excel_modelo: DataFrame, arquivo: DataFrame\n) -&gt; Tuple[bool, str]:\n\"\"\"\n    Verifica se o arquivo recebido tem o mesmo n\u00famero de linhas em rela\u00e7\u00e3o ao modelo.\n    \"\"\"\n    num_linhas_df1 = len(excel_modelo)\n    num_linhas_df2 = len(arquivo)\n    return num_linhas_df1 == num_linhas_df2, num_linhas_df2 - num_linhas_df1\n</code></pre> <p>Verifica se o arquivo recebido tem os mesmos datatype em rela\u00e7\u00e3o ao modelo.</p> Source code in <code>app/validacoes/tipos_dados.py</code> <pre><code>def validar_tipos_dados(\n    excel_modelo: DataFrame, arquivo: DataFrame\n) -&gt; Tuple[bool, str]:\n\"\"\"\n    Verifica se o arquivo recebido tem os mesmos datatype em rela\u00e7\u00e3o ao modelo.\n    \"\"\"\n    colunas_comuns = set(excel_modelo.columns).intersection(\n        set(arquivo.columns)\n    )\n    colunas_com_tipos_diferentes = [\n        col\n        for col in colunas_comuns\n        if excel_modelo[col].dtype != arquivo[col].dtype\n    ]\n    return len(colunas_com_tipos_diferentes) == 0, colunas_com_tipos_diferentes\n</code></pre> <p>Caso qualquer valida\u00e7\u00e3o seja identificada como invalido, ele marca o arquivo como invalido.</p>"},{"location":"#tabela-modelo","title":"Tabela modelo","text":"<p>O arquivo modelo \u00e9 o arquivo Excel que deve seguir como template. Ele cont\u00e9m a estrutura que os arquivos Excel recebidos devem seguir. Ele deve ser colocado no diret\u00f3rio <code>data/modelo/</code>.</p> Coluna A type: Int Coluna B type: Int Coluna C type: Int Coluna D type: Int Coluna E type: Int 44 47 64 67 67 9 83 21 36 87 70 88 88 12 58 65 39 87 46 88 81 37 25 77 72 9 20 80 69 79 47 64 82 99 88 49 29 19 19 14 39 32 65 9 57 32 31 74 23 35"},{"location":"#folder-input","title":"Folder input","text":"<p>No folder input voc\u00ea encontra 5 arquivos, cada um deles com uma divergencia do Modelo</p>"},{"location":"#arquivo-1","title":"Arquivo 1","text":"<p>O arquivo 1 \u00e9 um arquivo Excel que cont\u00e9m a estrutura correta.</p> Coluna A type: Int Coluna B type: Int Coluna C type: Int Coluna D type: Int Coluna E type: Int 75 55 28 34 0 0 36 53 5 38 17 79 4 42 58 31 1 65 41 57 35 11 46 82 91 0 14 99 53 12 42 84 75 68 6 68 47 3 76 52 78 15 20 99 58 23 79 13 85 48"},{"location":"#arquivo-2","title":"Arquivo 2","text":"<p>O arquivo 2 \u00e9 um arquivo Excel que cont\u00e9m a estrutura incorreta, apresenta uma coluna a menos.</p> Coluna A type: Int Coluna B type: Int Coluna C type: Int Coluna D type: Int 49 69 41 35 64 95 69 94 0 50 36 34 48 93 3 98 42 77 21 73 0 10 43 58 23 59 2 98 62 35 94 67 82 46 99 20 81 50 27 14"},{"location":"#arquivo-3","title":"Arquivo 3","text":"<p>O arquivo 3 \u00e9 um arquivo Excel que cont\u00e9m a estrutura incorreta, apresenta uma coluna a mais, coluna f.</p> Coluna A type: Int Coluna B type: Int Coluna C type: Int Coluna D type: Int Coluna E type: Int Coluna F type: Int 41 58 65 36 10 86 43 11 2 51 80 32 54 0 38 19 46 42 56 60 77 30 24 2 3 94 98 13 40 72 19 95 72 26 66 52 67 61 14 96 4 67 11 86 77 75 56 16 24 29 21 25 80 60 61 83 33 32 70 85"},{"location":"#arquivo-4","title":"Arquivo 4","text":"<p>O arquivo 4 \u00e9 um arquivo Excel que cont\u00e9m a estrutura incorreta, a ordem das colunas est\u00e1 diferente.</p> Coluna A type: Int Coluna B type: Int Coluna C type: Int Coluna E type: Int Coluna D type: Int 31 13 71 56 24 79 41 18 40 54 79 11 38 93 1 95 44 88 24 67 82 3 76 35 86 61 69 87 43 32 11 84 10 54 37 28 2 27 83 89 23 53 51 46 20 53 29 67 35 39"},{"location":"#arquivo-5","title":"Arquivo 5","text":"<p>O arquivo 5 \u00e9 um arquivo Excel que cont\u00e9m a estrutura incorreta, o n\u00famero de linhas est\u00e1 diferente. A linha 12 foi adicionada.</p> Coluna A type: Int Coluna B type: Int Coluna C type: Int Coluna D type: Int Coluna E type: Int 9 73 41 23 3 46 90 50 3 31 9 10 27 45 71 39 61 85 97 44 34 34 88 33 5 36 0 75 34 69 53 80 62 8 61 1 81 35 91 40 36 48 25 67 35 66 43 24 4 12 30 29 33 18 17"}]}